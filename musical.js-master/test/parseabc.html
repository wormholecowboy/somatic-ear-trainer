<script src="lib/qunit.js"></script>
<script src="lib/fake_timers.js"></script>
<script src="../musical.js"></script>
<link href="lib/qunit.css" rel="stylesheet">
<body>
<div id="qunit"></div>
<script>
module("Test of the parseABCFile function.");
asyncTest("Parses New York State of Mind.", function() {
  var result = parseABCFile(
    "X: 1\n" +
    "T: New York State of Mind (By: Sambuka of Firefoot)\n" +
    "Z: Billy Joel\n" +
    "L: 1/4\n" +
    "Q: 120\n" +
    "K: C\n" +
    "\n" +
    "[F/4c3/8G/4F,17/8] z/4 [c/4F/4^G/4] z/4 [^G/4c/4F/4] z3/4\n" +
    "[^D/4^G/4c3/8F/4] z3/4 [F5/4=D9/8^G5/4^A,33/8] z11/8 [c9/8z/2]\n"
  );
  deepEqual(result,
    {
      X: "1",
      T: "New York State of Mind (By: Sambuka of Firefoot)",
      Z: "Billy Joel",
      unitnote: 0.25,
      L: "1/4",
      tempo: 120,
      Q: "120",
      K: "C",
      voice: {
        "": {
          id: "",
          stems: [
            {
              notes: [
                {
                  pitch: "F",
                  tie: false,
                  frequency: 349.2282314330039,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "c",
                  tie: false,
                  frequency: 523.2511306011972,
                  duration: "3/8",
                  time: 0.375
                }, {
                  pitch: "G",
                  tie: false,
                  frequency: 391.99543598174927,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "F,",
                  tie: false,
                  frequency: 174.61411571650194,
                  duration: "17/8",
                  time: 1.875
                }
              ],
              duration: "/4",
              staccato: false,
              time: 0.25
            }, {
              notes: [],
              duration: "/4",
              staccato: false,
              time: 0.25
            }, {
              notes: [
                {
                  pitch: "c",
                  tie: false,
                  frequency: 523.2511306011972,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "F",
                  tie: false,
                  frequency: 349.2282314330039,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "^G",
                  tie: false,
                  frequency: 415.3046975799451,
                  duration: "/4",
                  time: 0.25
                }
              ],
              duration: "/4",
              staccato: false,
              time: 0.25
            }, {
              notes: [],
              duration: "/4",
              staccato: false,
              time: 0.25
            }, {
              notes: [
                {
                  pitch: "^G",
                  tie: false,
                  frequency: 415.3046975799451,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "c",
                  tie: false,
                  frequency: 523.2511306011972,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "F",
                  tie: false,
                  frequency: 349.2282314330039,
                  duration: "/4",
                  time: 0.25
                }
              ],
              duration: "/4",
              staccato: false,
              time: 0.25
            }, {
              notes: [],
              duration: "3/4",
              staccato: false,
              time: 0.75
            }, {
              notes: [
                {
                  pitch: "^D",
                  tie: false,
                  frequency: 311.12698372208087,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "^G",
                  tie: false,
                  frequency: 415.3046975799451,
                  duration: "/4",
                  time: 0.25
                }, {
                  pitch: "c",
                  tie: false,
                  frequency: 523.2511306011972,
                  duration: "3/8",
                  time: 0.375
                }, {
                  pitch: "F",
                  tie: false,
                  frequency: 349.2282314330039,
                  duration: "/4",
                  time: 0.25
                }
              ],
              duration: "/4",
              staccato: false,
              time: 0.25
            }, {
              notes: [],
              duration: "3/4",
              staccato: false,
              time: 0.75
            },
            {
              notes: [
                {
                  pitch: "F",
                  tie: false,
                  frequency: 349.2282314330039,
                  duration: "5/4",
                  time: 1.25
                }, {
                  pitch: "D",
                  tie: false,
                  frequency: 293.6647679174076,
                  duration: "9/8",
                  time: 1.125
                }, {
                  pitch: "^G",
                  tie: false,
                  frequency: 415.3046975799451,
                  duration: "5/4",
                  time: 1.25
                }, {
                  pitch: "^A,",
                  tie: false,
                  frequency: 233.08188075904496,
                  duration: "33/8",
                  time: 3.375
                }
              ],
              duration: "9/8",
              staccato: false,
              time: 1.125
            }, {
              notes: [],
              duration: "11/8",
              staccato: false,
              time: 1.125
            }, {
              notes: [
                {
                  pitch: "c",
                  tie: false,
                  frequency: 523.2511306011972,
                  duration: "9/8",
                  time: 1.125
                }
              ],
              duration: "/2",
              staccato: false,
              time: 0.5
            }
          ]
        }
      }
    }
  );
  start();
});

</script>

